CREATE DATABASE DnD;

use Dnd;

CREATE TABLE Book (
	Book_ID int NOT NULL UNIQUE,
    Book_Name varchar(30) NOT NULL,
    Book_Version varchar(10) NOT NULL,
    Book_Print_Date date,
    PRIMARY KEY (Book_ID)
);

CREATE TABLE Material (
	Material_ID int NOT NULL UNIQUE,
	Book_ID int NOT NULL,
    Material_Name varchar(15) NOT NULL,
    Material_Item_Type varchar(6) NOT NULL,
    Material_Description TEXT,
    PRIMARY KEY (Material_ID, Book_ID),
    FOREIGN KEY (Book_ID) REFERENCES Book(Book_ID)
);

CREATE TABLE Armor (
	Armor_ID int NOT NULL UNIQUE,
    Book_ID int NOT NULL,
    Armor_Name varchar(20) NOT NULL,
    Armor_Category varchar(6) NOT NULL CHECK (Armor_Category IN ("Light", "Medium", "Heavy", "Shield")),
    Armor_Cost decimal(9,2) NOT NULL,
    Armor_AC_Bonus int NOT NULL,
    Armor_Max_Dex int,
    Armor_Check_Penalty int NOT NULL,
    Armor_Spell_Failure int NOT NULL,
    Armor_30_Speed int,
    Armor_20_Speed int,
    Armor_Weight decimal(4,2) NOT NULL,
    Armor_Rarity varchar(8) NOT NULL CHECK (Armor_Rarity IN ("Common", "Uncommon")),
    Armor_Description TEXT,
    PRIMARY KEY (Armor_ID, Book_ID),
    FOREIGN KEY (Book_ID) REFERENCES Book(Book_ID)
);

CREATE TABLE Weapon (
	Weapon_ID int NOT NULL UNIQUE,
    Book_ID int NOT NULL,
    Weapon_Name varchar(25) NOT NULL,
    Weapon_Category varchar(7) NOT NULL CHECK (Weapon_Category IN ("Simple", "Martial", "Exotic")),
    Weapon_Type varchar(16) NOT NULL CHECK (Weapon_Type IN ("Unarmed Melee", "Light Melee", "One-Handed Melee", "Two-Handed Melee", "Ranged")),
    Weapon_Cost decimal(9,2) NOT NULL,
    Weapon_Small_Damage varchar(9),
    Weapon_Medium_Damage varchar(9),
    Weapon_Critical varchar(8),
    Weapon_Range_Increment int,
    Weapon_Damage_Type varchar(11),
    Weapon_Weight decimal(4,2) NOT NULL,
    Weapon_Rarity varchar(8) NOT NULL CHECK (Weapon_Rarity IN ("Common", "Uncommon")),
    Weapon_Description TEXT,
    PRIMARY KEY (Weapon_ID, Book_ID),
    FOREIGN KEY (Book_ID) REFERENCES Book(Book_ID)
);

CREATE TABLE Magic_Armor (
	Magic_Armor_ID int NOT NULL UNIQUE,
    Book_ID int NOT NULL,
    Magic_Armor_Name varchar(20) NOT NULL,
    Magic_Armor_Modifier int,
    Magic_Armor_Cost decimal(9,2),
    Magic_Armor_Description TEXT,
    PRIMARY KEY (Magic_Armor_ID, Book_ID),
    FOREIGN KEY (Book_ID) REFERENCES Book(Book_ID)
);

CREATE TABLE Magic_Weapon (
	Magic_Weapon_ID int NOT NULL UNIQUE,
    Book_ID int NOT NULL,
    Magic_Weapon_Name varchar(20) NOT NULL,
    Magic_Weapon_Modifier int,
    Magic_Weapon_Cost decimal(9,2),
    Magic_Weapon_Description TEXT,
    PRIMARY KEY (Magic_Weapon_ID, Book_ID),
    FOREIGN KEY (Book_ID) REFERENCES Book(Book_ID)
);

CREATE TABLE Magic_Item (
	Magic_Item_ID int NOT NULL UNIQUE,
    Book_ID int NOT NULL,
    Magic_Item_Name varchar(40) NOT NULL,
    Magic_Item_Cost decimal(9,2) NOT NULL,
    Magic_Item_Description TEXT,
    PRIMARY KEY (Magic_Item_ID, Book_ID),
    FOREIGN KEY (Book_ID) REFERENCES Book(Book_ID)
);

CREATE TABLE Spell (
	Spell_ID int NOT NULL UNIQUE,
    Book_ID int NOT NULL,
    Spell_Name varchar(30) NOT NULL,
    Spell_Type varchar(6) NOT NULL CHECK (Spell_Type IN ("Arcane", "Divine", "Both")),
    Spell_School varchar(13) NOT NULL CHECK (Spell_School IN ("Abjuration", "Conjuration", "Divination", "Enchantment", "Evocation", "Illusion", "Necromancy", "Transmutation", "Universal", "Other")),
    Spell_Subschool varchar(12) CHECK (Spell_Subschool IN ("Calling", "Creation", "Healing", "Summoning", "Teleporation", "Scrying", "Charm", "Compulsion", "Figment", "Glamer", "Pattern", "Phantasm", "Shadow")),
    Spell_Descriptor varchar(18) CHECK (Spell_Descriptor IN ("Acid", "Air", "Chaotic", "Cold", "Darkness", "Death", "Earth", "Electricity", "Evil", "Fear", "Fire", "Force", "Good", "Language-Dependant", "Lawful", "Light", "Mind-Affecting", "Sonic", "Water")),
    Spell_Level int NOT NULL CHECK (Spell_Level BETWEEN 0 AND 9),
    Spell_Class_Level varchar(19) NOT NULL,
    Spell_Components varchar(10) NOT NULL,
    Spell_Casting_Time varchar(25) NOT NULL,
    Spell_Range varchar(6) NOT NULL,
    Spell_Effect varchar(30),
    Spell_Duration varchar(15) NOT NULL,
    Spell_Saving_Throw varchar(30) NOT NULL,
    Spell_Resistance varchar(22),
    Spell_Description TEXT,
    PRIMARY KEY (Spell_ID, Book_ID),
    FOREIGN KEY (Book_ID) REFERENCES Book(Book_ID)
);

CREATE TABLE Spell_Item (
	Spell_Item_ID int NOT NULL UNIQUE,
    Book_ID int NOT NULL,
    Spell_Item_Name varchar(30) NOT NULL,
    Spell_Item_Cost decimal(9,2) NOT NULL,
    Spell_Item_Type varchar(10) NOT NULL,
    Spell_ID int,
    PRIMARY KEY (Spell_Item_ID, Book_ID),
    FOREIGN KEY (Book_ID) REFERENCES Book(Book_ID),
    FOREIGN KEY (Spell_ID) REFERENCES Spell(Spell_ID)
);